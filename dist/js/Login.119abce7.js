(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"28fe":function(g,o,c){},"4ffd":function(g,o,c){g.exports=c.p+"img/logo.f3bcb14b.png"},"5b53":function(g,o,c){"use strict";c.r(o);var n=function(){var g=this,o=g.$createElement,c=g._self._c||o;return c("div",{staticClass:"loginPage"},[c("transition",{attrs:{name:"slide-fade"}},[c("div",{directives:[{name:"show",rawName:"v-show",value:!g.showAD,expression:"!showAD"}],staticClass:"card loginCenter"},[c("div",{staticClass:"languageWarp",on:{click:g.showActive}},[c("p",{staticClass:"languageCenter"},[g._v(g._s(g.localLanguge)),c("i",{staticClass:"iconfont icon-downarrow"})])]),c("div",{staticClass:"logo"},[c("img",{attrs:{src:g.LogoSrc,alt:""}})]),c("div",{staticClass:"logForm"},[c("div",{directives:[{name:"show",rawName:"v-show",value:g.accountLogin,expression:"accountLogin"}],staticClass:"account flex"},[c("p",[g._v(g._s(g.$t("loginMsg.accountPlace"))+":")]),c("cube-input",{staticClass:"input",attrs:{placeholder:g.$t("loginMsg.errorMsg.account")},model:{value:g.logObj.account,callback:function(o){g.$set(g.logObj,"account",o)},expression:"logObj.account"}})],1),c("div",{directives:[{name:"show",rawName:"v-show",value:g.accountLogin,expression:"accountLogin"}],staticClass:"password flex"},[c("p",[g._v(g._s(g.$t("loginMsg.passwordPlace"))+":")]),c("cube-input",{staticClass:"input",attrs:{type:"password",placeholder:g.$t("loginMsg.errorMsg.password")},model:{value:g.logObj.password,callback:function(o){g.$set(g.logObj,"password",o)},expression:"logObj.password"}})],1),c("div",{directives:[{name:"show",rawName:"v-show",value:!g.accountLogin,expression:"!accountLogin"}],staticClass:"account flex"},[c("p",[g._v(g._s(g.$t("loginMsg.phone"))+":")]),c("cube-input",{staticClass:"input",attrs:{maxlength:11,placeholder:g.$t("loginMsg.errorMsg.phoneNub")},model:{value:g.logObj.phone,callback:function(o){g.$set(g.logObj,"phone",o)},expression:"logObj.phone"}})],1),c("div",{directives:[{name:"show",rawName:"v-show",value:!g.accountLogin,expression:"!accountLogin"}],staticClass:"password flex"},[c("p",[g._v(g._s(g.$t("loginMsg.smsCode"))+":")]),c("cube-input",{staticClass:"input",attrs:{placeholder:g.$t("loginMsg.errorMsg.smsCodeErr")},model:{value:g.logObj.smscode,callback:function(o){g.$set(g.logObj,"smscode",o)},expression:"logObj.smscode"}}),c("div",{staticClass:"getSmsBtn",class:{disable:g.hasGetSms},on:{click:g.getSmsCode}},[g._v(g._s(g.smsCode))])],1),c("cube-button",{attrs:{type:"submit"},on:{click:g.signIn}},[g._v(g._s(g.$t("loginMsg.loginBtn")))]),c("div",{staticClass:"tagWarp"},[c("p",{class:{active:!g.accountLogin},on:{click:function(o){g.changeLoginWay("account")}}},[g._v(g._s(g.$t("loginMsg.labelAccPass")))]),c("p",{staticClass:"smsCode",class:{active:g.accountLogin},on:{click:function(o){g.changeLoginWay("sms")}}},[g._v(g._s(g.$t("loginMsg.labelSmsCode")))])])],1)])])],1)},v=[],f=c("cd54"),i=c("d48e"),l=c("a2ba"),w={name:"login",data:function(){return{LogoSrc:c("4ffd"),localLanguge:"中文",accountLogin:!0,smsCode:Object(l["a"])("loginMsg.getSmsCode"),logObj:{},hasGetSms:!1,showAD:!1}},mounted:function(){this.loginLoading=Object(f["b"])()},methods:{signIn:function(){this.accountLogin?this.doAccountLogin():this.phoneLogon()},doAccountLogin:function(){var g=this;if(this.logObj.account)if(this.logObj.password){var o={account:this.logObj.account,password:this.logObj.password};this.loginLoading.show("登录中..."),this.$api.login(o).then(function(c){g.loginLoading.hide();var n=c.data;if(0===n.code){localStorage.setItem("accPwd",JSON.stringify(o)),sessionStorage.setItem("token",c.headers.token),sessionStorage.setItem("loginData",JSON.stringify(n.data)),g.$store.commit("setUserLoginData",n.data);var v=n.data,f=v.companyId,i=v.id;g.getCompanyPermissions(f,i)}})}else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.password"));else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.account"))},getCompanyPermissions:function(g,o){var c=this;this.$api.getCompanyRole(g).then(function(g){var n=g.data;console.log("CompanyPermissions",n),0===n.code&&(sessionStorage.setItem("CompanyPermissions",n.data),c.getUserPermissions(o))})},getUserPermissions:function(g){var o=this;this.$api.permissions(g).then(function(g){var c=g.data;console.log("UserPermissions",c),0===c.code&&(sessionStorage.setItem("UserPermissions",c.data),o.$router.push({name:"Home"}))})},getSmsCode:function(){var g=this;if(!this.hasGetSms)if(this.logObj.phone)if(Object(i["b"])(this.logObj.phone)){var o=60;this.$api.SMScode({phone:this.logObj.phone}).then(function(c){if(console.log(c),c.data&&0===c.data.code){g.hasGetSms=!0;var n=setInterval(function(){o--,g.smsCode="".concat(o,"s"),o<1&&(g.smsCode=Object(l["a"])("loginMsg.getSmsCode"),g.hasGetSms=!1,clearInterval(n))},1e3);Object(f["a"])(Object(l["a"])("loginMsg.smsSuccess"))}})}else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.checkPhone"));else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.phoneNub"))},phoneLogon:function(){var g=this;if(this.logObj.phone)if(Object(i["b"])(this.logObj.phone))if(this.logObj.smscode){var o={phone:this.logObj.phone,code:this.logObj.smscode};this.loginLoading.show("登录中..."),this.$api.SMSVertify(o).then(function(o){console.log(o),g.loginLoading.hide();var c=o.data;if(0===c.code){sessionStorage.setItem("token",o.headers.token),sessionStorage.setItem("loginData",JSON.stringify(c.data)),g.$store.commit("setUserLoginData",c.data);var n=c.data,v=n.companyId,f=n.id;g.getCompanyPermissions(v,f)}})}else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.smsCodeErr"));else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.checkPhone"));else Object(f["a"])(Object(l["a"])("loginMsg.errorMsg.phoneNub"))},changeLoginWay:function(g){this.accountLogin="account"===g},showActive:function(){var g=this;this.$createActionSheet({data:[{content:"中文",local:"zh"},{content:"English",local:"en"}],onSelect:function(o){console.log(o),g.localLanguge=o.content}}).show()}}},C=w,M=(c("8850"),c("048f")),L=Object(M["a"])(C,n,v,!1,null,"10a276bc",null);L.options.__file="login.vue";o["default"]=L.exports},8850:function(g,o,c){"use strict";var n=c("28fe"),v=c.n(n);v.a},d48e:function(g,o,c){"use strict";c.d(o,"b",function(){return f}),c.d(o,"a",function(){return i});var n=/^1[3|4|5|7|8][0-9]\d{8}$/,v=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$ /;function f(g){return n.test(g)}function i(g){return v.test(g)}}}]);
//# sourceMappingURL=Login.119abce7.js.map