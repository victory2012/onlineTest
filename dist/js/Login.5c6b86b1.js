(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"4e3f":function(s,o,e){},"4ffd":function(s,o,e){s.exports=e.p+"img/logo.f3bcb14b.png"},"5b53":function(s,o,e){"use strict";e.r(o);var t=function(){var s=this,o=s.$createElement,e=s._self._c||o;return e("div",{staticClass:"loginPage"},[e("transition",{attrs:{name:"slide-fade"}},[e("div",{staticClass:"card loginCenter"},[e("div",{staticClass:"languageWarp",on:{click:s.showActive}},[e("p",{staticClass:"languageCenter"},[s._v(s._s(s.localLanguge)),e("i",{staticClass:"iconfont icon-downarrow"})])]),e("div",{staticClass:"logo"},[e("img",{attrs:{src:s.LogoSrc,alt:""}})]),e("div",{staticClass:"logForm"},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.accountLogin,expression:"accountLogin"}],staticClass:"account flex"},[e("p",[s._v(s._s(s.$t("loginMsg.accountPlace"))+":")]),e("cube-input",{staticClass:"input",attrs:{placeholder:s.$t("loginMsg.errorMsg.account")},model:{value:s.logObj.account,callback:function(o){s.$set(s.logObj,"account",o)},expression:"logObj.account"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:s.accountLogin,expression:"accountLogin"}],staticClass:"password flex"},[e("p",[s._v(s._s(s.$t("loginMsg.passwordPlace"))+":")]),e("cube-input",{staticClass:"input",attrs:{type:"password",placeholder:s.$t("loginMsg.errorMsg.password")},model:{value:s.logObj.password,callback:function(o){s.$set(s.logObj,"password",o)},expression:"logObj.password"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.accountLogin,expression:"!accountLogin"}],staticClass:"account flex"},[e("p",[s._v(s._s(s.$t("loginMsg.phone"))+":")]),e("cube-input",{staticClass:"input",attrs:{maxlength:11,placeholder:s.$t("loginMsg.errorMsg.phoneNub")},model:{value:s.logObj.phone,callback:function(o){s.$set(s.logObj,"phone",o)},expression:"logObj.phone"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.accountLogin,expression:"!accountLogin"}],staticClass:"password flex"},[e("p",[s._v(s._s(s.$t("loginMsg.smsCode"))+":")]),e("cube-input",{staticClass:"input",attrs:{placeholder:s.$t("loginMsg.errorMsg.smsCodeErr")},model:{value:s.logObj.smscode,callback:function(o){s.$set(s.logObj,"smscode",o)},expression:"logObj.smscode"}}),e("div",{staticClass:"getSmsBtn",class:{disable:s.hasGetSms},on:{click:s.getSmsCode}},[s._v(s._s(s.smsCode))])],1),e("cube-button",{attrs:{type:"submit"},on:{click:s.signIn}},[s._v(s._s(s.$t("loginMsg.loginBtn")))]),e("div",{staticClass:"tagWarp"},[e("p",{class:{active:!s.accountLogin},on:{click:function(o){s.changeLoginWay("account")}}},[s._v(s._s(s.$t("loginMsg.labelAccPass")))]),e("p",{staticClass:"smsCode",class:{active:s.accountLogin},on:{click:function(o){s.changeLoginWay("sms")}}},[s._v(s._s(s.$t("loginMsg.labelSmsCode")))])])],1)])])],1)},n=[],a=e("a6b5"),i=e.n(a),c=e("cd54"),l=e("d48e"),g=e("a2ba"),r={name:"login",data:function(){return{LogoSrc:e("4ffd"),localLanguge:"中文",accountLogin:!0,smsCode:Object(g["a"])("loginMsg.getSmsCode"),logObj:{},hasGetSms:!1}},mounted:function(){this.loginLoading=Object(c["b"])()},methods:{signIn:function(){this.$router.push({name:"Home"})},doAccountLogin:function(){var s=this;if(this.logObj.account)if(this.logObj.password){var o={account:this.logObj.account,password:this.logObj.password};this.loginLoading.show("登录中..."),this.$api.login(o).then(function(e){s.loginLoading.hide();var t=e.data;if(0===t.code){localStorage.setItem("accPwd",i()(o)),sessionStorage.setItem("token",e.headers.token),sessionStorage.setItem("loginData",i()(t.data)),s.$store.commit("setUserLoginData",t.data);var n=t.data,a=n.companyId,c=n.id;s.getCompanyPermissions(a,c)}})}else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.password"));else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.account"))},getCompanyPermissions:function(s,o){var e=this;this.$api.getCompanyRole(s).then(function(s){var t=s.data;console.log("CompanyPermissions",t),0===t.code&&(sessionStorage.setItem("CompanyPermissions",t.data),e.getUserPermissions(o))})},getUserPermissions:function(s){var o=this;this.$api.permissions(s).then(function(s){var e=s.data;console.log("UserPermissions",e),0===e.code&&(sessionStorage.setItem("UserPermissions",e.data),o.$router.push({name:"Home"}))})},getSmsCode:function(){var s=this;if(!this.hasGetSms)if(this.logObj.phone)if(Object(l["b"])(this.logObj.phone)){var o=60;this.$api.SMScode({phone:this.logObj.phone}).then(function(e){if(console.log(e),e.data&&0===e.data.code){s.hasGetSms=!0;var t=setInterval(function(){o--,s.smsCode="".concat(o,"s"),o<1&&(s.smsCode=Object(g["a"])("loginMsg.getSmsCode"),s.hasGetSms=!1,clearInterval(t))},1e3);Object(c["a"])(Object(g["a"])("loginMsg.smsSuccess"))}})}else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.checkPhone"));else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.phoneNub"))},phoneLogon:function(){var s=this;if(this.logObj.phone)if(Object(l["b"])(this.logObj.phone))if(this.logObj.smscode){var o={phone:this.logObj.phone,code:this.logObj.smscode};this.loginLoading.show("登录中..."),this.$api.SMSVertify(o).then(function(o){console.log(o),s.loginLoading.hide();var e=o.data;if(0===e.code){sessionStorage.setItem("token",o.headers.token),sessionStorage.setItem("loginData",i()(e.data)),s.$store.commit("setUserLoginData",e.data);var t=e.data,n=t.companyId,a=t.id;s.getCompanyPermissions(n,a)}})}else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.smsCodeErr"));else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.checkPhone"));else Object(c["a"])(Object(g["a"])("loginMsg.errorMsg.phoneNub"))},changeLoginWay:function(s){this.accountLogin="account"===s},showActive:function(){var s=this;this.$createActionSheet({data:[{content:"中文",local:"zh"},{content:"English",local:"en"}],onSelect:function(o){console.log(o),s.localLanguge=o.content}}).show()}}},d=r,u=(e("7c6d"),e("25c1")),h=Object(u["a"])(d,t,n,!1,null,"adfa5084",null);h.options.__file="login.vue";o["default"]=h.exports},"7c6d":function(s,o,e){"use strict";var t=e("4e3f"),n=e.n(t);n.a},d48e:function(s,o,e){"use strict";e.d(o,"b",function(){return a}),e.d(o,"a",function(){return i});var t=/^1[3|4|5|7|8][0-9]\d{8}$/,n=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$ /;function a(s){return t.test(s)}function i(s){return n.test(s)}}}]);
//# sourceMappingURL=Login.5c6b86b1.js.map